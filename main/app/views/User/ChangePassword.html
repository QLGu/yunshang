{{set . "title" "修改密码"}}
{{template "header.html" .}}

<div class="container">
    <h2>修改密码</h2>
    <hr>
    {{template "flash.html" .}}
    {{if eq .session.from "Local"}}
    {{else}}
    你从{{.session.from}}登录, </b>设置本站密码后， 可通过账号<code>{{.session.login}}</code>登录本系统</b>
    {{end}}
    {{if .hasPassword}}
    <p>修改本站登录密码</p>

    <form id="changerPasswordForm" action='{{url "User.ChangePassword"}}' method="post">
        {{with $field := field "oldPassword" .}}
        <p class="{{$field.ErrorClass}}">
            <strong>旧密码:</strong>
            <input type="password" size="20" name="{{$field.Name}}" value="{{$field.Flash}}" required="">
            * <span class="error">{{$field.Error}}</span>
        </p>
        {{end}}

        {{with $field := field "password" .}}
        <p class="{{$field.ErrorClass}}">
            <strong>新密码:</strong>
            <input type="password" size="20" name="{{$field.Name}}" value="{{$field.Flash}}" required="">
            * (6位以上）<span class="error">{{$field.Error}}</span>
        </p>
        {{end}}

        {{with $field := field "confirmPassword" .}}
        <p class="{{$field.ErrorClass}}">
            <strong>确认新密码:</strong>
            <input type="password" size="20" name="{{$field.Name}}" value="{{$field.Flash}}" required="">
            *<span class="error">{{$field.Error}}</span>
        </p>
        {{end}}

        <p><input type="submit" value="提交"></p>
    </form>
    {{else}}
    <p></b>设置本站密码</b></p>
    <form id="changerPasswordForm" action='{{url "User.SetPassword"}}' method="post">
        {{with $field := field "password" .}}
        <p class="{{$field.ErrorClass}}">
            <strong>密码:</strong>
            <input type="password" size="20" name="{{$field.Name}}" value="{{$field.Flash}}" required="">
            * (6位以上）<span class="error">{{$field.Error}}</span>
        </p>
        {{end}}

        {{with $field := field "confirmPassword" .}}
        <p class="{{$field.ErrorClass}}">
            <strong>确认密码:</strong>
            <input type="password" size="20" name="{{$field.Name}}" value="{{$field.Flash}}" required="">
            *<span class="error">{{$field.Error}}</span>
        </p>
        {{end}}

        <p><input type="submit" value="提交"></p>
    </form>

    {{end}}
</div>

{{template "footer.html" .}}
